---
layout: default
title: "[9.2]Towards Predicting Any Human Trajectory In Context"
---

# [9.2] Towards Predicting Any Human Trajectory In Context

- Authors: Ryo Fujii, Hideo Saito, Ryo Hachiuma
- [arXiv Link](https://arxiv.org/abs/2506.00871)
- [PDF Link](https://arxiv.org/pdf/2506.00871.pdf)

## Subfields
 轨迹预测 / 领域适应 / 上下文学习 (In-Context Learning)
## Reason for Interest

这篇论文在自动驾驶领域具有极高的研究价值和实际应用潜力。其核心创新点在于将In-Context Learning (ICL)框架引入行人轨迹预测，旨在解决自动驾驶系统在不同环境和领域中泛化能力不足，且无法在边缘设备上进行昂贵微调的挑战。

**创新性：**
1.  **首次将ICL应用于轨迹预测：** 这一思路极具创新性，通过在推理时无需权重更新的自适应能力，有效解决了模型在多样化场景下泛化和部署的实际难题。
2.  **STES（时空相似性选择）：** 提出的基于时空相似性的示例选择方法，能够从过去轨迹中识别出具有相似运动模式的上下文示例，为ICL提供了有效的基础。
3.  **PG-ES（预测引导的示例选择）：** 这是最显著的创新之一。通过结合过去轨迹和**预测的未来轨迹**来选择示例，模型能更好地捕获长期意图和多模态行为，弥补了仅依赖过去轨迹的不足。
4.  **合成数据训练与跨域泛化：** 模型仅在大规模合成数据集MOTSynth上训练，却能有效泛化到多个真实世界数据集（如JRDB、WildTrack、SDD、JTA等），且性能优于甚至超越了在目标域上进行微调的方法，这对于实际部署具有重大意义。

**实验完整性与可信度：**
1.  **全面的基准测试：** 论文在多个主流的行人轨迹预测数据集上进行了广泛的实验验证，包括域内和跨域评估，对比了香草模型（Social-Transmotion）及其多种微调变体（如Full FT, LoRA, VPT, Head Tuning）。
2.  **详细的消融研究：** 对STES、PG-ES、RCPE、SRPE等关键组件以及模型架构、观察轨迹长度、示例池大小等因素进行了深入的消融实验，充分证明了各组件的有效性。
3.  **真实世界鲁棒性验证：** 在使用上游检测器和跟踪器产生的有噪声输入（非真实轨迹）的情况下，TrajICL相比基线模型表现出显著更高的鲁棒性（基线性能下降30.8%，TrajICL仅下降4.1%），这极大地增强了其在自动驾驶场景中的实用性和可信度。
4.  **有限示例池下的SOTA表现：** 在数据稀缺的场景（仅10%示例数据）下，TrajICL仍能超越其他微调方法，凸显了其高效的自适应能力。
5.  **定性分析：** 定性结果展示了TrajICL能生成更合理、与地面真值更一致的预测轨迹，并能感知地图障碍物，避免不合理运动。

**行业潜力：**
1.  **降低边缘设备负担：** 无需在推理时进行微调，显著减少了自动驾驶车辆边缘设备的计算和内存开销，加速了模型部署。
2.  **提升泛化能力：** 有效应对不同运营设计域（ODD）带来的挑战，减少了为每个新场景重新训练或微调模型的成本和复杂性。
3.  **关键模块：** 行人轨迹预测是自动驾驶决策规划的关键输入，TrajICL的自适应性和鲁棒性直接提升了自动驾驶系统的安全性和可靠性。

**不足与展望：**
论文也坦诚目前模型的总体推理成本较高，并提出了未来通过Token Merging等技术进行优化的方向，这体现了研究的严谨性。

**总结：** 鉴于其在核心技术上的突破性创新、详尽扎实的实验验证以及对自动驾驶实际部署问题的精准切入和显著贡献，该论文在自动驾驶研究领域具有非常高的价值。
## Abstract: 
Predicting accurate future trajectories of pedestrians is essential for autonomous systems but remains a challenging task due to the need for adaptability in different environments and domains. A common approach involves collecting scenario-specific data and performing fine-tuning via backpropagation. However, the need to fine-tune for each new scenario is often impractical for deployment on edge devices. To address this challenge, we introduce TrajICL, an In-Context Learning (ICL) framework for pedestrian trajectory prediction that enables adaptation without fine-tuning on the scenario-specific data at inference time without requiring weight updates. We propose a spatio-temporal similarity-based example selection (STES) method that selects relevant examples from previously observed trajectories within the same scene by identifying similar motion patterns at corresponding locations. To further refine this selection, we introduce prediction-guided example selection (PG-ES), which selects examples based on both the past trajectory and the predicted future trajectory, rather than relying solely on the past trajectory. This approach allows the model to account for long-term dynamics when selecting examples. Finally, instead of relying on small real-world datasets with limited scenario diversity, we train our model on a large-scale synthetic dataset to enhance its prediction ability by leveraging in-context examples. Extensive experiments demonstrate that TrajICL achieves remarkable adaptation across both in-domain and cross-domain scenarios, outperforming even fine-tuned approaches across multiple public benchmarks. Project Page: https://fujiry0.github.io/TrajICL-project-page/.
