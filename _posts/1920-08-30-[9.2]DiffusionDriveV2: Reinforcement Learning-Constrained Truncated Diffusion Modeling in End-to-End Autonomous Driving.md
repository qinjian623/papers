---
layout: default
title: "[9.2]DiffusionDriveV2: Reinforcement Learning-Constrained Truncated Diffusion Modeling in End-to-End Autonomous Driving"
---

# [9.2] DiffusionDriveV2: Reinforcement Learning-Constrained Truncated Diffusion Modeling in End-to-End Autonomous Driving

- Authors: Jialv Zou, Shaoyu Chen, Bencheng Liao, Zhiyu Zheng, Yuehao Song, Lefei Zhang, Qian Zhang,...
- [arXiv Link](https://arxiv.org/abs/2512.07745)
- [PDF Link](https://arxiv.org/pdf/2512.07745.pdf)

## Subfields
 端到端自动驾驶 / 轨迹规划 (End-to-End Autonomous Driving / Trajectory Planning)
## Reason for Interest

该论文具有极高的创新性和实用价值。1. **方法创新**：针对基于扩散模型的端到端规划中“模仿学习缺乏负样本约束”和“多样性与高质量难以兼得”的痛点，创新性地引入了强化学习（RL）进行后处理微调。2. **算法设计巧妙**：借鉴大模型领域 DeepSeek-R1 的 GRPO 思想，并针对轨迹规划的多模态（Multi-modal）特性，提出了 Intra-Anchor GRPO（锚点内分组优化以保持模态多样性）和 Inter-Anchor Truncated GRPO（锚点间截断优势以引入全局安全约束），有效避免了直接应用 RL 导致的模式坍缩。此外，提出的尺度自适应乘性噪声（Scale-Adaptive Multiplicative Noise）比传统加性噪声更适合轨迹探索。3. **实验扎实**：在权威 benchmark NAVSIM v1 和 v2 上均取得了 SOTA 成绩，且证明了仅用 ResNet-34 即可超越使用更大模型的基线，展示了极高的效率和潜力。4. **逻辑清晰**：消融实验充分证明了各个模块（特别是两种 GRPO 策略）的有效性。
## Abstract: 
Generative diffusion models for end-to-end autonomous driving often suffer from mode collapse, tending to generate conservative and homogeneous behaviors. While DiffusionDrive employs predefined anchors representing different driving intentions to partition the action space and generate diverse trajectories, its reliance on imitation learning lacks sufficient constraints, resulting in a dilemma between diversity and consistent high quality. In this work, we propose DiffusionDriveV2, which leverages reinforcement learning to both constrain low-quality modes and explore for superior trajectories. This significantly enhances the overall output quality while preserving the inherent multimodality of its core Gaussian Mixture Model. First, we use scale-adaptive multiplicative noise, ideal for trajectory planning, to promote broad exploration. Second, we employ intra-anchor GRPO to manage advantage estimation among samples generated from a single anchor, and inter-anchor truncated GRPO to incorporate a global perspective across different anchors, preventing improper advantage comparisons between distinct intentions (e.g., turning vs. going straight), which can lead to further mode collapse. DiffusionDriveV2 achieves 91.2 PDMS on the NAVSIM v1 dataset and 85.5 EPDMS on the NAVSIM v2 dataset in closed-loop evaluation with an aligned ResNet-34 backbone, setting a new record. Further experiments validate that our approach resolves the dilemma between diversity and consistent high quality for truncated diffusion models, achieving the best trade-off. Code and model will be available at https://github.com/hustvl/DiffusionDriveV2
