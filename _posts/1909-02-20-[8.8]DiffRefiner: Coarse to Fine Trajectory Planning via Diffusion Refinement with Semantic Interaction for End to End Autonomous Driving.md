---
layout: default
title: "[8.8]DiffRefiner: Coarse to Fine Trajectory Planning via Diffusion Refinement with Semantic Interaction for End to End Autonomous Driving"
---

# [8.8] DiffRefiner: Coarse to Fine Trajectory Planning via Diffusion Refinement with Semantic Interaction for End to End Autonomous Driving

- Authors: Liuhan Yin, Runkun Ju, Guodong Guo, Erkang Cheng
- [arXiv Link](https://arxiv.org/abs/2511.17150)
- [PDF Link](https://arxiv.org/pdf/2511.17150.pdf)

## Subfields
 端到端自动驾驶 / 轨迹规划 (End-to-End Autonomous Driving / Trajectory Planning)
## Reason for Interest

论文提出了一种结合判别式提议（Proposal）与生成式扩散（Diffusion）的混合规划框架 DiffRefiner。其核心价值在于：
1. 创新架构：采用由粗到精（Coarse-to-Fine）的策略，先通过 Transformer 解码器生成基于锚点的高质量粗略轨迹，再利用扩散模型进行细化。这种方法有效解决了纯扩散模型推理耗时和纯回归模型难以处理多模态分布的矛盾，实现了高性能与低延迟（27ms）的平衡。
2. 细粒度语义交互：提出了 FGSIM 模块，通过交叉注意力和可变形注意力，将 BEV 语义（可行驶区域、交通参与者）显式地融入去噪过程，增强了轨迹的场景依从性和安全性。
3. 扎实的实验结果：在 NAVSIM（开环）和 Bench2Drive（闭环）两个主流基准上均取得了 SOTA 成绩，且消融实验充分验证了各模块（特别是语义交互和混合架构）的有效性。该方法具有较高的落地潜力。
## Abstract: 
Unlike discriminative approaches in autonomous driving that predict a fixed set of candidate trajectories of the ego vehicle, generative methods, such as diffusion models, learn the underlying distribution of future motion, enabling more flexible trajectory prediction. However, since these methods typically rely on denoising human-crafted trajectory anchors or random noise, there remains significant room for improvement. In this paper, we propose DiffRefiner, a novel two-stage trajectory prediction framework. The first stage uses a transformer-based Proposal Decoder to generate coarse trajectory predictions by regressing from sensor inputs using predefined trajectory anchors. The second stage applies a Diffusion Refiner that iteratively denoises and refines these initial predictions. In this way, we enhance the performance of diffusion-based planning by incorporating a discriminative trajectory proposal module, which provides strong guidance for the generative refinement process. Furthermore, we design a fine-grained denoising decoder to enhance scene compliance, enabling more accurate trajectory prediction through enhanced alignment with the surrounding environment. Experimental results demonstrate that DiffRefiner achieves state-of-the-art performance, attaining 87.4 EPDMS on NAVSIM v2, and 87.1 DS along with 71.4 SR on Bench2Drive, thereby setting new records on both public benchmarks. The effectiveness of each component is validated via ablation studies as well.
